version: '1.0'
label: Infoflow
description: A test domain for organizing and aggregating data to higher-level information and knowledge
graphql: true
active: true
schema:

  # test allow comments
  # case variations in class names are intentional

  data_source:
    description: An external location or system where Infoflow collects its data
    resolver: source
    attributes:
      created: created
      updated: updated
      name: label
      info: data
      tags: strings
      connection_data: subdoc
      complex_data: nested_subdoc
      examples: subdocs
      timeref: datetime
      arbitrary_subdoc: arbitrary_subdoc
      arbitrary_subdocs: arbitrary_subdocs
      nested_arbitrary_subdoc: nested_arbitrary_subdoc
      nested_arbitrary_subdocs: nested_arbitrary_subdocs
    triggers:
      - set_created
      - set_updated
      - audit

  Data Producer:
    description: A data producer rule
    resolver: ruleset
    attributes:
      created: created
      updated: updated
      name: label
      rules: rules
      expressions: expressions
      groups: groups
      additional_data: additional_data
    triggers:
      - set_created
      - set_updated
      - audit

  bit data:
    description: A small piece of data
    resolver: data
    permissive: output
    operations:
      - read
    attributes:
      created: created
      data: data
    relations:
      origin: [data_source, origin, outbound]
    triggers:
      - set_created

  byte data:
    description: An aggregate data container generated by a Data Producer from a set of bit data
    resolver: data
    permissive: output
    operations:
      - create
      - read
    attributes:
      created: created
      data: data
    relations:
      bits: [[bit data], origin, outbound]
      origin: [[data_source, Data Producer, bit data], origin, 1..2 outbound]
    triggers:
      - set_created

  Slot:
    description: A system slot
    resolver: entity
    operations:
      - read
    attributes:
      created: created
      identifier: label
      info: data
    triggers:
      - set_created

  Address:
    description: A memory or system address
    resolver: entity
    operations:
      - read
    attributes:
      created: created
      identifier: label
      info: data
    triggers:
      - set_created

  Bus:
    description: A system bus
    resolver: entity
    operations:
      - read
    attributes:
      created: created
      identifier: label
      info: data
    triggers:
      - set_created

  Account:
    description: A system account
    resolver: entity
    operations:
      - read
    attributes:
      created: created
      identifier: label
      info: data
    triggers:
      - set_created

  Notification Rule:
    description: A set of rules to collect byte data into notifications
    resolver: ruleset
    attributes:
      created: created
      updated: updated
      name: label
      rules: rules
    triggers:
      - set_created
      - set_updated

  Notification:
    description: A set of byte data organized for display
    resolver: grouping
    permissive: input
    operations:
      - read
      - update
    attributes:
      created: created
      updated: updated
      info: data
    relations:
      origins: [[Notification Rule, byte data], origin, outbound]
      objects: [[Slot, Address, Bus, Account], includes, outbound]
      comments: [[Comment], comment_on, inbound]
    triggers:
      - set_created
      - set_updated

  Dataset:
    description: A set of notifications and related data, or search results and related data
    resolver: grouping
    attributes:
      creator: creator
      created: created
      updated: updated
      name: label
      description: data
    relations:
      origins: [[Notification, Search Result], origin, outbound]
      objects: [[ANY], includes, outbound]
      comments: [[Comment], comment_on, inbound]
    triggers:
      - set_creator
      - set_created
      - set_updated
      - audit

  Search Result:
    description: A set of user-driven search results
    resolver: grouping
    permissive: output
    attributes:
      creator: creator
      created: created
      updated: updated
      name: label
      description: data
    relations:
      objects: [[ANY], includes, outbound]
      comments: [[Comment], comment_on, inbound]
    triggers:
      - set_creator
      - set_created
      - set_updated
      - audit

  Ultra Search Result:
    description: A class class-resolving to another class (clash of the classes)
    resolver: grouping
    class: search_result
    attributes:
      creator: creator
      created: created
      updated: updated
      name: label
      description: data
    relations:
      objects: [[ANY], includes, outbound]
      comments: [[Comment], comment_on, inbound]
    triggers:
      - set_creator
      - set_created
      - set_updated

  Comment:
    description: A comment on any other item
    resolver: comment
    attributes:
      author: creator
      created: created
      updated: updated
      content: data
    relations:
      comment_on: [[ANY], comment_on, outbound]
    triggers:
      - set_creator
      - set_created
      - set_updated
      - audit

  amalgam:
    description: A test structure with class aliases
    resolver: data
    constants:
      sanity_check: amalgam
    operations:
      - read
    attributes:
      data: data

  create-only:
    description: A weird create-only test structure
    alias: amalgam
    resolver: data
    constants:
      sanity_check: create-only
    operations:
      - create
    attributes:
      data: data

  update-only:
    description: A weird update-only test structure
    alias: amalgam
    resolver: data
    constants:
      sanity_check: update-only
    operations:
      - update
    attributes:
      data: data

  delete-only:
    description: A weird delete-only test structure
    alias: amalgam
    resolver: data
    operations:
      - delete

  talker:
    description: A test structure for writeOnly fields
    resolver: talker
    attributes:
      author: creator
      created: created
      name: label
      data: data
      events: events
    triggers:
      - set_creator
      - set_created

  listener:
    description: A test structure for readOnly fields
    resolver: listener
    attributes:
      name: label
      data: data

  defaulter:
    description: A test structure for default fields
    resolver: defaulter
    attributes:
      active: active

  subtyper_a:
    description: A test structure for default fields
    resolver: subtyper_a
    attributes:
      subdoc: subdoc

  subtyper_b:
    description: A test structure for default fields
    resolver: subtyper_b
    attributes:
      subdoc: subdoc

  meta:
    description: A meta test structure
    resolver: comment
    attributes:
      data: data
    relations:
      meta: [[meta], comment_on, outbound]

  constant:
    description: A test structure for constants
    resolver: data
    constants:
      test_a: value
      test_b: 1
      test_c: 1.01
      test_d: true

  nullable:
    description: A test structure for nullable fields
    resolver: data
    attributes:
      name: label
      description: data

  hidden:
    description: A non-interactive, hidden object type
    resolver: data
    operations: []

  brand_new_class:
    description: NEW NEW NEW
    resolver: new_class
    operations:
      - create
      - read
      - update
    constants:
      object_type: brand_new_class
    attributes:
      _id: _id
      created: created
      updated: updated
      archived: archived
      name: label
      description: data
      start_date: start_date
      end_date: end_date
    triggers:
      - set_created
      - set_updated
      - audit
